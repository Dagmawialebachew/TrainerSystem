{% extends "form_base.html" %}
{% load widget_tweaks %}

{% block form_title %}Add Food{% endblock %}
{% block form_method %}post{% endblock %}
{% block back_url %}{% url 'nutrition:food_list' %}{% endblock %}
{% block submit_text %}Save Food{% endblock %}

{% block form_fields %}
<div class="space-y-4">

    <!-- Tabs Navigation -->
    <div class="flex space-x-2 overflow-x-auto pb-2 border-b border-gray-200 w-full">
        <button type="button" class="tab-btn px-4 min-w-max py-2 rounded-lg bg-primary-100 text-primary-800 font-semibold" data-tab="basic">Basic Info</button>
        <button type="button" class="tab-btn px-4 min-w-max py-2 rounded-lg text-primary-600 font-semibold" data-tab="nutrition">Nutrition</button>
        <button type="button" class="tab-btn px-4 min-w-max py-2 rounded-lg text-primary-600 font-semibold" data-tab="contextual">Contextual Info</button>
        <button type="button" class="tab-btn px-4 min-w-max py-2 rounded-lg text-primary-600 font-semibold" data-tab="dietary">Dietary Compatibility</button>
    </div>

    <!-- Tabs Content -->
    <div class="tabs-content space-y-4">

        <!-- Basic Info -->
        <div class="tab-panel" id="basic">
            {% for field in form %}
                {% if field.name in "name name_amharic category" %}
                <div class="flex flex-col mb-4">
                    <label class="block text-sm font-medium text-primary-800 mb-1">{{ field.label }}</label>
                    {{ field|add_class:"w-full px-4 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-400" }}
                    {% if field.help_text %}
                        <p class="text-xs text-gray-500">{{ field.help_text }}</p>
                    {% endif %}
                    {% if field.errors %}
                        <p class="text-xs text-red-600">{{ field.errors|join:", " }}</p>
                    {% endif %}
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Nutrition -->
        <div class="tab-panel hidden" id="nutrition">
            {% for field in form %}
                {% if field.name in "calories_per_100g protein_per_100g carbs_per_100g fat_per_100g fiber_per_100g" %}
                <div class="flex flex-col mb-4">
                    <label class="block text-sm font-medium text-primary-800 mb-1">{{ field.label }}</label>
                    {{ field|add_class:"w-full px-4 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-400" }}
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Contextual Info -->
        <div class="tab-panel hidden" id="contextual">
            {% for field in form %}
                {% if field.name in "description seasonal_availability cultural_significance preparation_notes" %}
                <div class="flex flex-col mb-4">
                    <label class="block text-sm font-medium text-primary-800 mb-1">{{ field.label }}</label>
                    {{ field|add_class:"w-full px-4 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-400" }}
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Dietary Compatibility -->
        <div class="tab-panel hidden" id="dietary">
            {% for field in form %}
                {% if field.name in "is_vegetarian is_vegan is_gluten_free is_fasting_friendly" %}
                <div class="flex items-center gap-2 mb-4">
                    {{ field|add_class:"w-5 h-5" }}
                    <label class="text-sm text-primary-800">{{ field.label }}</label>
                </div>
                {% endif %}
            {% endfor %}
        </div>

      

    </div>
</div>

<!-- JS for Tabs -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-panel');

    tabButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            // Deactivate all buttons and panels
            tabButtons.forEach(b => b.classList.remove('bg-primary-100','text-primary-800'));
            tabButtons.forEach(b => b.classList.add('text-primary-600'));
            tabPanels.forEach(p => p.classList.add('hidden'));

            // Activate clicked tab
            btn.classList.add('bg-primary-100','text-primary-800');
            btn.classList.remove('text-primary-600');
            const tab = btn.getAttribute('data-tab');
            document.getElementById(tab).classList.remove('hidden');
        });
    });

  

});
</script>
{% endblock %}
